<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>发布图文</title>
		<link href="../css/mui.min.css" rel="stylesheet" />
		<link rel="stylesheet" type="text/css" href="../fonts/iconfont/iconfont.css" />
		<link rel="stylesheet" type="text/css" href="../css/global.css" />
		<link rel="stylesheet" href="../css/addnote.css" />
	</head>

	<body class="bg_white" ng-app="App" ng-controller="releaseController">
		<header class="mui-bar mui-bar-nav bg_white" style="text-align: center;">
			<a class="mui-icon mui-icon-left-nav mui-pull-left" id='confirmBtn'></a>
			<h1 class="mui-title">
				<div class="mui-segmented-control">
				    <a class="mui-control-item mui-active file_btn"  >图文内容</a>
				    <a class="mui-control-item video_btn" >视频内容</a>
				</div>
		   </h1>
		</header>
		<div class="mui-content">
			<div></div>
			<!--发布图文内容-->
			<ul class="mui-table-view bg_white">
				<!--上传图片 start-->
				<li class="mui-table-view-cell bg_white up_file">
					<div id="show_pic7" class="note_subject">
						<i class="iconfont ">&#xe62b;</i>
						<img src="" id="a1" ng-src="{{subject_img}}" ng-if="subject_img"  />
					</div>
					<label for="uploadimg7" class="sp_label ">点击添加主体图片</label>
				</li>
				<!--上传图片 end-->

				<!--上传视频 start-->
				<li class="border-bottom padding_tb11px up_video mui-hidden">
					<div id="show_video" class="video_box">
						<video ng-src="{{viedoUrl}}" width="100%" height="100%" id="video"></video>
					</div>
					<label for="uploadimg7" class="sp_label" style="width: 100%;">点击添加视频文件</label>
					<div class="progress_bar_box">
						<button type="button" ng-click="viedo_upload()">上传</button>
					</div>
				</li>
				<!--上传视频 end-->

				<li class="mui-table-view-cell padding0 bg_white">
					<div class="mui-input-row">
						<label>标题</label>
						<input type="text" class="mui-input-clear font14" id="releaseTitle" placeholder="请输入标题">
					</div>
				</li>
				<li class="mui-input-row border-bottom category">
					<a class="mui-navigate-right">
						<label class="color333">所属分类</label>
						<p class="mui-pull-right padding_r28px color333 line-height37px current_type"></p>
					</a>
				</li>
				<li class="mui-table-view-cell bg_white">
					<span class="mui-pull-left">图文内容</span>
					<div class="upload_btn mui-pull-right">
						<span class="mui-pull-right colorP " id="note_subject">载入图片</span>
						<!--<input type="file" id="upload_pic"/>-->
					</div>
				</li>
				<li class="padding0 bg_white">
					<textarea name="" rows="8" cols="" class="borderNone font14" placeholder="再次输入想添加的内容，还可在右上角载入图片" id="releaseContent"></textarea>
					<ul class="img_show padding_lr_10px mui-clearfix width100"></div>
				</li>
				<li ng-click="add_tag()" class="mui-table-view-cell bg_white">
					<a class="mui-navigate-right">
						<span class="color333">添加标签…</span>
					</a>
				</li>
				<li class="mui-table-view-cell bg_white" ng-click="add_group()">
					<a class="mui-navigate-right">
						<span class="color333">选择关联的群…</span>
					</a>
				</li>
				<li ng-click="add_goods()" class="mui-table-view-cell bg_white">
					<a class="mui-navigate-right">
						<span class="color333">选择关联的商品…</span>
					</a>
				</li>
				<div class="paddingl_r_15px_tb11px">
					<span class="font14">请阅读</span>&nbsp;
					<a class="law">《知识产权承诺》</a>
				</div>
				<li class="mui-table-view-cell">
					<button type="button" id="submit_btn" class="mui-btn-blue  btn_half" disabled ng-click="releasesub()">发&nbsp;布</button>
				</li>
			</ul>

			<!--阅读知识产权承诺书弹框-->
			<div class="alert_window" id="law">
				<div class="share_list" id="law_text" style="bottom: 10%;">
					<p class="mui-text-center border-bottom line-height44px font16 color333">知识产权承诺</p>
					<div style="overflow-y: scroll;height: 400px;padding: 0 15px;margin-bottom:20px">
						<p class="color333 font12 margin-top10px">
							承诺并保证，您在去卖艺网（www.myee.net.cn）及“去卖艺APP”移动客户端以各种形式发布的作品及信息，均符合《中华人民共和国著作权法》、《中华人民共和国商标法》、《中华人民共和国反不正当竞争法》、《中华人民共和国侵权责任法》、《中华人民共和国广告法》、《中华人民共和国计算机信息系统安全保护条例》、《计算机软件保护条例》及《信息网络传播权保护条例》等有关法律、法规、规章的规定。
						</p>
						<p class="color333 font12">
							您承诺并保证，您在去卖艺网（www. myee.net.cn）及“去卖艺APP”移动客户端以各种形式发布的信息，均符合社会公序良俗。
						</p>
						<p class="color333 font12">
							您承诺并保证，您在去卖艺网（www.myee.net.cn）及“去卖艺APP”移动客户端上传的作品、文字、图片、视频、音频、多媒体资料或其他内容均拥有相应合法的权利。这些文字、图片、视频、音频、多媒体资料或其他内容，不侵犯任何第三方的肖像权、名誉权、著作权、商标权等任何权利，不违反您与任何第三方所签订的任何法律文件的规定。
						</p>
						<p class="color333 font12">
							去卖艺公司有权对您上传的作品、文字、图片、视频、音频、多媒体资料或其他内容随时进行检查或编辑。如果发现您上传的内容不符合前述承诺，去卖艺公司有权删除您所上传的内容。对于您通过去卖艺网（www.myee.net.cn）及“去卖艺APP”移动客户端上传的内容，去卖艺公司不保证其合法性、正当性、准确性或完整性。您应自行承担因此产生的法律责任，如果因您违反上述承诺及保证导致去卖艺公司因此受到损失，您应赔偿由此造成的全部损失。
						</p>
						<p class="color333 font12">
							您在点击确认本承诺之前，请仔细阅读本承诺，并确认您已完全理解本承诺。如您对本承诺有任何疑问，请立即停止通过去卖艺网（www.myee.net.cn）及“去卖艺APP”移动客户端上传的作品、文字、图片、视频、音频、多媒体资料或其他内容，并可向去卖艺网客服咨询。
						</p>
						<div class="mui-input-row mui-checkbox mui-left">
							<label>我已阅读并同意</label>
							<input name="checkbox1" type="checkbox" class="is_allow_release">
						</div>
					</div>
				</div>
			</div>

			<!--所属分类弹框-->
			<div class="alert_window" id="category">
				<div class="share_list" id="sub_item">
					<p class="mui-text-center border-bottom line-height44px font16 color333">所属分类</p>
					<div class="category_list" style="overflow-y: scroll;height: 220px;">
						<div class="mui-table-view-cell mui-collapse">
							<div class="mui-input-row mui-radio border-bottom " ng-repeat="(i,cc) in cates">
								<label>{{cc.name}}</label>
								<input name="radio" type="radio" cate_id="{{cc.id}}">
							</div>
						</div>
						<div class="btn_group">
							<button type="button" class="mui-btn mui-btn-grey mui-btn-block padding_tb_8px margin0 color333 cancel_btn">取消</button>
							<button type="button" class="mui-btn mui-btn-blue mui-btn-block padding_tb_8px margin0 confirm_btn" id="releaseClass">确定</button>
						</div>
					</div>
				</div>
			</div>

		</div>
	</body>
	<script src="../js/mui.min.js"></script>
	<script src="../js/open.js"></script>
	<script type="text/javascript" src="../js/angular.min.js"></script>
	<script src="../js/jquery.min.js"></script>
	<script src="../js/upload_pic.js"></script>
	<script src="../js/shareApp.js"></script>
	<script src="../js/apppublic.js"></script>
	<script src="../js/app/releaseVideo.js"></script>
	<script type="text/javascript">
		mui.init({
			gestureConfig: {
				longtap: true, //默认为false
			}
		});
        mui.back = function() {
				window.plus.bridge.execSync("community", "backNews", "");
				mui.currentWebview.close();
			}
		//longtap点击事件
		$('.show_pic img').on('longtap', function() {
			$(this).siblings('.del_btn').css('display', 'block');
			$('.show_pic .del_btn').click(function() {
				$(this).prev().attr('src', "");
				$(this).css('display', 'none');
				return false;
			})
		})
		
		//删除“加载图片”添加的图片
		$('body').on('click','.img_show i',function(){
			$(this).parent().remove();
		})
		
		var is_play = true;
		$('#show_video').on('tap',function(){
			if(is_play){
				document.querySelector('video').play();
				is_play = false;
			} else {
				document.querySelector('video').pause();
				is_play = true;
			}
			
		})
		
		document.addEventListener('plusready',function(){
			$("#submit_btn").on('tap',function(){
				var _val = plus.storage.getItem('releaseTags');
				console.log(_val)
			});
		})
		



		//确认是否退出发布
		document.getElementById("confirmBtn").addEventListener('tap', function() {
			var btnArray = ['是', '否'];
			mui.confirm('确定退出发布图文内容？', '发布图文内容', btnArray, function(e) {
				if(e.index == 0) {
                    window.plus.bridge.execSync("community","backNews","");
					plus.webview.getWebviewById('release_viewMedia.html').close();
				} else {
					return;
				}
			})
		});

		$(function() {
			$('.confirm_btn').click(function() {
				$('.alert_window').css('display', 'none');
				var val = $('.category_list input:checked').prev().html();
				$('.current_type').html(val);
				return false;
			});

			$(".is_allow_release").click(function() {
				if($(this).is(':checked')) {
					$('#submit_btn').attr('disabled', false);
					$('#law').fadeOut(300);
					event.stopPropagation();
				} else {
					$('#submit_btn').attr('disabled', true);
				}
			})
			//发布商品所属分类弹窗
			share($('#category'), $('#sub_item'), $('.category'), $('.cancel_btn'));

			//阅读知识产权承诺
			share($('#law'), $('#law_text'), $('.law'), $('.cancel_btn'));
		})

		
	</script>

</html>